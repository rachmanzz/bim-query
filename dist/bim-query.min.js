"use strict";var _this=void 0,axios=require("axios"),bim=require("bim"),bimquery=function(){_this.query={},_this.baseurl=null,_this.auth=null},opt=[{q:"<",al:"s"},{q:"<=",al:"sq"},{q:">",al:"b"},{q:">=",al:"bq"},{q:"!=",al:"not"}],filterOpt=function(i){var e=opt.filter(function(e){return e.q===i});return 0===bim.size(e)?null:e[0].al};bimquery.prototype.where=function(e,i,r){if(bim.isArray(e))for(var t=e.length,s=0;s<t;s++){var u=e[s];if(bim.isArray(u)){var h=bim.size(u);2<=h&&u<=3&&bim.iString(u[0])&&(3===h?_this.where(u[0],u[1],u[2]):_this.where(u[0],u[1]))}}else if(bim.iString(e)&&bim.isNotUndef(i))if(bim.isNotUndef(_this.query.where))if(bim.isArray(_this.query.where))bim.isNumber(i)?_this.query.where.push(bim.isUndef(r)?e+"|!"+i:e+"|!"+r+"|"+filterOpt(i)):_this.query.where.push(bim.isUndef(r)?e+"|"+i:e+"|"+r+"|"+filterOpt(i));else{var b=[];b.push(_this.query.where),_this.query.where=b,bim.isNumber(i)?_this.query.where.push(bim.isUndef(r)?e+"|!"+i:e+"|!"+r+"|"+filterOpt(i)):_this.query.where.push(bim.isUndef(r)?e+"|"+i:e+"|"+r+"|"+filterOpt(i))}else bim.isNumber(i)?_this.query.where=bim.isUndef(r)?e+"|!"+i:e+"|!"+r+"|"+filterOpt(i):_this.query.where=bim.isUndef(r)?e+"|"+i:e+"|"+r+"|"+filterOpt(i);return _this},bimquery.prototype.orwhere=function(e,i,r){if(bim.isArray(e))for(var t=e.length,s=0;s<t;s++){var u=e[s];if(bim.isArray(u)){var h=bim.size(u);2<=h&&u<=3&&bim.iString(u[0])&&(3===h?_this.where(u[0],u[1],u[2]):_this.where(u[0],u[1]))}}else if(bim.iString(e)&&bim.isNotUndef(i))if(bim.isNotUndef(_this.query.orwhere))if(bim.isArray(_this.query.orwhere))bim.isNumber(i)?_this.query.orwhere.push(bim.isUndef(r)?e+"|!"+i:e+"|!"+r+"|"+filterOpt(i)):_this.query.orwhere.push(bim.isUndef(r)?e+"|"+i:e+"|"+r+"|"+filterOpt(i));else{var b=[];b.push(_this.query.orwhere),_this.query.orwhere=b,bim.isNumber(i)?_this.query.orwhere.push(bim.isUndef(r)?e+"|!"+i:e+"|!"+r+"|"+filterOpt(i)):_this.query.orwhere.push(bim.isUndef(r)?e+"|"+i:e+"|"+r+"|"+filterOpt(i))}else bim.isNumber(i)?_this.query.orwhere=bim.isUndef(r)?e+"|!"+i:e+"|!"+r+"|"+filterOpt(i):_this.query.orwhere=bim.isUndef(r)?e+"|"+i:e+"|"+r+"|"+filterOpt(i);return _this},bimquery.prototype.between=function(e,i,r){if(bim.isArray(e))for(var t=e.length,s=0;s<t;s++){var u=e[s];bim.isArray(u)&&3===bim.size(u)&&_this.between(u[0],u[1],u[2])}else if(bim.iString(e)&&bim.isNumber(i)&&bim.isNumber(r))if(bim.isNotUndef(_this.query.between))if(bim.isArray(_this.query.between))_this.query.between.push(e+"|"+i+"-"+r);else{var h=[];h.push(_this.query.between),_this.query.between=h,_this.query.between.push(e+"|"+i+"-"+r)}else _this.query.between=e+"|"+i+"-"+r;return _this},bimquery.prototype.groupby=function(e){return _this.query.groupby=e,_this},bimquery.prototype.offset=function(e){return _this.query.offset=e,_this},bimquery.prototype.limit=function(e){return _this.query.limit=e,_this},bimquery.prototype.orderby=function(e,i){if(bim.isNotUndef(_this.query.orderby))if(bim.isArray(_this.query.orderby))_this.query.orderby.push(e+"|"+i);else{var r=[];r.push(_this.query.orderby),_this.query.orderby=r,_this.query.orderby.push(e+"|"+i)}else _this.query.orderby=e+"|"+i;return _this},bimquery.prototype.with=function(e){if(bim.isNotUndef(e))if(bim.isArray(_this.query.with))_this.query.with.push(e);else{var i=[];i.push(_this.query.with),_this.query.with=i,_this.query.with.push(e)}else _this.query.with=e;return _this},bimquery.prototype.paginate=function(e,i){return bim.isNotUndef(i)?_this.query.paginate=e+"|"+i:_this.query.paginate=e,_this},bimquery.prototype.page=function(e,i){return bim.isNotUndef(i)?_this.query.paginate=e+"|"+i:_this.query.paginate=e,_this},bimquery.prototype.first=function(){return _this.query.first=!0,_this},bimquery.prototype.generate=function(){return _this.query},bimquery.prototype.setUrl=function(e){_this.baseurl=e},bimquery.prototype.release=function(){_this.query={}},bimquery.prototype.auth=function(e){_this.auth="Bearer "+e},bimquery.prototype.get=function(e,i){var r=null!==_this.baseurl?_this.baseurl+e:e,t=bim.isObj(i)?i:{};return null!==_this.auth&&(t.headers={Authorization:_this.auth}),bim.isObj(t.params)&&(t.params=bim.merge(t.params,_this.query)),axios.get(r,t)},bimquery.prototype.post=function(e,i,r){var t=null!==_this.baseurl?_this.baseurl+e:e,s=bim.isObj(r)?r:{};return null!==_this.auth&&(s.headers={Authorization:_this.auth}),bim.isObj(s.params)&&(s.params=bim.merge(s.params,_this.query)),axios.post(t,bim.isNotUndef(i)?i:{},s)},bimquery.prototype.put=function(e,i,r){var t=null!==_this.baseurl?_this.baseurl+e:e,s=bim.isObj(r)?r:{};return null!==_this.auth&&(s.headers={Authorization:_this.auth}),bim.isObj(s.params)&&(s.params=bim.merge(s.params,_this.query)),axios.put(t,bim.isNotUndef(i)?i:{},s)},bimquery.prototype.delete=function(e,i){var r=null!==_this.baseurl?_this.baseurl+e:e,t=bim.isObj(i)?i:{};return null!==_this.auth&&(t.headers={Authorization:_this.auth}),bim.isObj(t.params)&&(t.params=bim.merge(t.params,_this.query)),axios.delete(r,t)},module.exports=function(){return new bimquery};
